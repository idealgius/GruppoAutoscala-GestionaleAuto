{% extends "base.html" %}

{% block title %}Modifica Ricambio{% endblock %}

{% block content %}
<h1 style="text-align:center;">âœï¸ Modifica Ricambio</h1>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul style="color:red; list-style:none; padding:0; text-align:center;">
      {% for msg in messages %}
        <li>{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<form action="{{ url_for('modifica_ricambio', id=ricambio['id']) }}" method="POST"
      style="max-width:600px; margin:0 auto; display:flex; flex-direction:column; gap:14px;">

    <!-- =============================== -->
    <!-- NOME                            -->
    <!-- =============================== -->
    <label for="nome">Nome ricambio:</label>
    <input type="text" id="nome" name="nome"
           value="{{ ricambio['nome'] }}" required>

    <!-- =============================== -->
    <!-- PREFISSO CODICE                 -->
    <!-- =============================== -->
    <label for="prefisso">Prefisso (opzionale):</label>
    <select id="prefisso" name="prefisso">
        <option value="">Nessuno</option>

        <option value="AVS" {% if ricambio['prefisso'] == 'AVS' %}selected{% endif %}>AVS</option>
        <option value="BH" {% if ricambio['prefisso'] == 'BH' %}selected{% endif %}>BH</option>
        <option value="DR" {% if ricambio['prefisso'] == 'DR' %}selected{% endif %}>DR</option>
        <option value="MM" {% if ricambio['prefisso'] == 'MM' %}selected{% endif %}>MM</option>
        <option value="CHA" {% if ricambio['prefisso'] == 'CHA' %}selected{% endif %}>CHA</option>
        <option value="XEN" {% if ricambio['prefisso'] == 'XEN' %}selected{% endif %}>XEN</option>
        <option value="MAN" {% if ricambio['prefisso'] == 'MAN' %}selected{% endif %}>MAN</option>
        <option value="MIC" {% if ricambio['prefisso'] == 'MIC' %}selected{% endif %}>MIC</option>
        <option value="JAP" {% if ricambio['prefisso'] == 'JAP' %}selected{% endif %}>JAP</option>
        <option value="UFI" {% if ricambio['prefisso'] == 'UFI' %}selected{% endif %}>UFI</option>
    </select>

    <!-- =============================== -->
    <!-- CODICE                          -->
    <!-- =============================== -->
    <label for="codice">Codice (unico):</label>
    <input type="text" id="codice" name="codice"
           value="{{ ricambio['codice'] }}" required>

    <!-- =============================== -->
    <!-- QUANTITÃ€                        -->
    <!-- =============================== -->
    <label for="quantita">QuantitÃ :</label>
    <input type="number" id="quantita" name="quantita"
           value="{{ ricambio['quantita'] }}" min="0" required>

    <!-- =============================== -->
    <!-- ğŸ” RICAMBIO SOSTITUENTE         -->
    <!-- =============================== -->
    <h3 style="margin-top:25px;">ğŸ” Ricambio Sostituente (opzionale)</h3>

    <label for="sost_codice_select">Seleziona ricambio sostituente:</label>
    <select id="sost_codice_select" name="sost_codice_select">
        <option value="">Nessuno</option>

        {% for r in ricambi %}
            <option value="{{ r['codice'] }}"
                {% if sostitutivo_corrente == r['codice'] %}selected{% endif %}>
                {{ r['codice'] }} â€” {{ r['nome'] }}
            </option>
        {% endfor %}
    </select>

    <small style="color:#666;">
        Scegli il ricambio sostituente dallâ€™elenco. Nessun inserimento manuale Ã¨ richiesto.
    </small>

    <!-- =============================== -->
    <!-- PASSWORD                        -->
    <!-- =============================== -->
    <label for="password" style="margin-top:20px;">
        ğŸ”‘ Inserisci la tua password per confermare:
    </label>
    <input type="password" id="password" name="password"
           placeholder="Password" required>

    <!-- =============================== -->
    <!-- SALVA                           -->
    <!-- =============================== -->
    <button type="submit" class="button">ğŸ’¾ Salva modifiche</button>
</form>

<div style="text-align:center; margin-top:25px;">
  <a class="button" href="/ricambi">ğŸ”™ Torna ai ricambi</a>
</div>

{% endblock %}
